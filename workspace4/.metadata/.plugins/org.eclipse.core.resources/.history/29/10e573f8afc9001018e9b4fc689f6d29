#include "trig.h"
static float cos512[256], sin512[256];
static float cos1024[512], sin1024[512];

int factorial(int a) {
	if(a==0) return 1;
	return a*factorial(a-1);
}

float cosine(float);

void init_fft_tables(int n) {
    if (n == 512) {
        for (int k = 0; k < 256; k++) {
            float a = -2.0f * PI * k / 512;
            cos512[k] = cosine(a);
            sin512[k] = sine(a);
        }
    }
    else if (n == 1024) {
        for (int k = 0; k < 512; k++) {
            float a = -2.0f * PI * k / 1024;
            cos1024[k] = cosine(a);
            sin1024[k] = sine(a);
        }
    }
}

float sine(float x) {
	if(x > (PI/2) || x < (-PI/2)){
		float d=x/2;
		return cosine(d)*sine(d)*2;
	}
	int i,j;
	float sine=0;
	float power;
	for(i=0;i<10;i++) {
		power=x;
		if(i!=0) {
			for(j=0;j<i*2;j++)
				power*=x;
		}
		if(i%2==1)
			power*=-1;
		sine+=power/factorial(2*i+1);
	}
	return sine;
}

float cosine(float x){
	float c,s;
	if(x > (PI/2) || x < (-PI/2)) {
		c=cosine(x/2);
		s=sine(x/2);
		return c*c-s*s;
	}
	int i,j;
	float cosine=0;
	float power;
	for(i=0;i<10;i++) {
		if(i==0) power=1;
		else power=x;
		if(i!=0) {
			for(j=0;j<i*2-1;j++)
				power*=x;
		}
		if(i%2==1)
			power*=-1;
		cosine+=power/factorial(2*i);
	}
	return cosine;	
}

float co(int k, int n, int b) {
	int idx = (k * n / (2 * b)) % (n / 2);
	return cos_cache[idx];
}

float si(int k, int n, int b) {
	int idx = (k * n / (2 * b)) % (n / 2);
	return sin_cache[idx];
}

